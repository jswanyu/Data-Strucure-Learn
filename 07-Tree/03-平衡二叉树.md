# 平衡二叉树

平衡二叉树，全称平衡二叉搜索树，又被称为AVL（Adelson-Velsky and Landis，发明人的姓名相关）树，即他依然是一棵二叉搜索树，只不过多了平衡的性质。

为什么要多平衡的性质，因为有序数据在二叉搜索树上可以退化为O(n)的链表。

![image-20220427123633151](https://jswanyu-1309100582.cos.ap-shanghai.myqcloud.com/picgo/DataStructure%20and%20Algorithm/%E4%BA%8C%E5%8F%89%E6%A0%91-%E4%BA%8C%E5%88%86%E6%90%9C%E7%B4%A2%E6%A0%91%E7%9A%84%E6%9C%80%E5%9D%8F%E6%83%85%E5%86%B5.png)



## 平衡二叉树的性质

平衡二叉树具有以下性质：

1. 可以是空树。
2. 假如不是空树，对于任意一个节点，左子树和右子树的高度差不能超过1

> 平衡二叉树的要求其实比完全二叉树要宽松一些，因为完全二叉树只能叶子节点没填满，其它必须满，那自然也符合平衡二叉树的定义，平衡二叉树只要左右子树高度差绝对值不超过1即可
>
> 另外从平衡二叉树的定义也能得出：平衡二叉树的高度和节点数量之间的关系也是O(logn)的

例如下图不是平衡二叉树，因为结点 60 的左子树不是平衡二叉树。

![img](https://pic1.zhimg.com/80/v2-e090a8e3171c8db07e1cda720039e700_720w.jpg)

下图因为虽然任何一个结点的左子树与右子树都是平衡二叉树，但66这个根节点来说，左子树高度为3，右子树高度为1，高度之差已经超过 1 。

<img src="https://pic3.zhimg.com/80/v2-7b3cbb7cf1d996c072516b7146144e52_720w.jpg" alt="img" style="zoom: 33%;" />

下图看起来树有点歪歪扭扭的，但它符合平衡二叉树的定义

![image-20220816213921147](https://jswanyu-1309100582.cos.ap-shanghai.myqcloud.com/picgo/DataStructure%20and%20Algorithm/AVL%E6%A0%91-%E6%AD%A3%E7%A1%AEAVL%E6%A0%91%E4%B8%BE%E4%BE%8B.png)







## 平衡因子

**定义：**某节点的左子树与右子树的高度（深度）差即为该节点的平衡因子（BF，Balance Factor）

平衡二叉树中不存在平衡因子大于 1 的节点。在一棵平衡二叉树中，节点的平衡因子只能取 0 、1 或者 -1 ，分别对应着左右子树等高，左子树比较高，右子树比较高。

下图中黑色数字为每个节点的高度，蓝色数字为平衡因子，显然，节点12和8都不满足平衡因子为0，1，-1，所以它不是一棵平衡二叉树

<img src="https://jswanyu-1309100582.cos.ap-shanghai.myqcloud.com/picgo/DataStructure%20and%20Algorithm/AVL%E6%A0%91-%E5%B9%B3%E8%A1%A1%E5%9B%A0%E5%AD%90.png" alt="image-20220523143045947" style="zoom:80%;" />





## 实现代码

这部分代码是基于前一节二分搜索树的代码。

与二分搜索树的不同主要在于

1、Node节点添加了一个 public int height; 属性，用于计算左右子树的高度差。

2、添加了一个计算平衡因子的方法

添加节点时，部分节点的高度会发生改变，会出现树的平衡性被破坏的情况，即getBalanceFactor(node)的绝对值有可能大于1。这时候就应该对树进行调整，保证getBalanceFactor(node)的绝对值小于等于1。



































